var mashapeKey="Fsz4qtOaKNmshsm6NqrJIFaLjD6jp1lWBaMjsn7wQaIvTisGiS",ingredientsList=[],currentItem,offsetAmount,convertIngtoStr="",cuisineType="",mealTime="",foodIntolerance="",$selectPopup=$(".white-popup-block"),createPDF=function(){var a=new jsPDF("p","pt","letter");a.addHTML($("#print").get(0),function(){a.save("Recipe Card.pdf")})},writeRecipe=function(a){var b=$(".white-popup-block"),c=b.find(".serving span em"),d=b.find(".ready_in span em"),e=b.find(".ingredients .list");b.find("h1").text(a.title),b.find(".imageRow img").attr("src",a.image),c.empty(),c.text(a.servings),d.empty(),d.text(a.readyInMinutes+" minutes"),b.find(".cardIntro em").text(a.title),e.empty();var f=a.extendedIngredients;f.forEach(function(a){var b=$("<p/>").appendTo(e);$("<img/>").attr("src",a.image).appendTo(b),$("<span/>").text(a.originalString).appendTo(b)})},writeMethodSteps=function(a){if(a.length>0){var b=a[0].steps;console.log($selectPopup),$(".white-popup-block .method").empty();var c=$("<ol/>");b.forEach(function(a){$("<li/>").text(a.step).appendTo(c)})}else{var c=$("<ol/>");linkname=linkname.toLowerCase();var d=$("<a/>").attr("href","https://spoonacular.com/recipes/"+linkname+"-"+id).text("Read the detailed instructions here");d.appendTo(c)}c.appendTo($(".white-popup-block .method"))};$(document).ready(function(){function a(a,b){return Math.floor(Math.random()*(b-a+1))+a}var b=function(a,b,c){$(".popup-modal").magnificPopup("open"),$.ajax({url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/"+a+"/information",type:"GET",data:{},dataType:"json",success:function(a){writeRecipe(a)},error:function(a){alert(a)}}),$.ajax({url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/"+a+"/summary",type:"GET",data:{},dataType:"json",success:function(a){console.log(a),$(".white-popup-block .summary").html(a.summary)},error:function(a){alert(a)}}),$.ajax({url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/"+a+"/analyzedInstructions?stepBreakdown=true",type:"GET",data:{},dataType:"json",success:function(a){console.log(a),writeMethodSteps(a)},error:function(a){alert(a)}}),$.ajax({url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/"+a+"/similar",type:"GET",data:{},dataType:"json",success:function(a){console.log(a);var b=$("#similar-recipies");e(a,b)},error:function(a){alert(a)}})};offsetAmount=a(0,800);var c=function(){var b="https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/searchComplex?limitLicense=false&number=100&offset=0&query=recipe&ranking=1";""==!mealTime&&(b=b+"&type="+mealTime),""==!cuisineType&&(b=b+"&cuisine="+encodeURI(cuisineType)),""==!convertIngtoStr&&(b=b+"&includeIngredients="+convertIngtoStr),""==!foodIntolerance&&(b=b+"&intolerances="+foodIntolerance),$.ajax({url:b,type:"GET",data:{},dataType:"json",success:function(b){var c={};c=b.results,f(c),0===b.results.length&&($("#mainIngredients label").text("Main Ingredient"),offsetAmount=a(0,800),d())},error:function(a){alert(a)}})},d=function(){$.ajax({url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/search?number=100&offset="+offsetAmount,type:"GET",data:{},dataType:"json",success:function(a){var b={};b=a.results,f(b)},error:function(a){alert(a)}})},e=function(a,c){c.empty();var d=$("<div/>").attr("id","dishes").addClass("grid");$("<div/>").addClass("grid-sizer").appendTo(d);a.forEach(function(a){var c=$("<div/>").addClass("grid-item"),e=a.title.replace(" ","-"),f=$("<a/>").attr("data-id",a.id).on("click",function(c){c.preventDefault(),console.log(a),b($(this).data("id"),e,this)}),g=($("<p/>").addClass("text-overlay").text(a.title).appendTo(f),"");g=a.image.indexOf("https")>-1?a.image:"https://webknox.com/recipeImages/"+a.image;$("<img/>").attr("src",g).appendTo(f);f.appendTo(c),c.appendTo(d)}),d.appendTo(c),d.masonry(),d.imagesLoaded().progress(function(){d.masonry("layout")})},f=function(a){var b=$("#results");b.empty(),e(a,b)},g=function(){$(".myIngredients li").removeClass("last");var a=$(".myIngredients li").length%2;a>0&&$(".myIngredients li:last-child").addClass("last")},h=function(){var a=ingredientsList.join(",");convertIngtoStr=escape(a),c()},i=function(){$("select[name=cuisine]").change(function(){var a=$("select[name=cuisine] option:selected").val();cuisineType=a,c()}),$("select[name=mealTime]").change(function(){var a=$("select[name=mealTime] option:selected").val();mealTime=a,c()}),$("select[name=foodIntolerance]").change(function(){var a=$("select[name=foodIntolerance] option:selected").val();foodIntolerance=a,c()})},j=function(){$(".hidefilter").show();var a=$(".myIngredients"),b=$("<li/>").text(currentItem),c=$("<a/>").addClass("remove").appendTo(b);c.bind("click",function(a){var b=$(this).parent().text(),c=ingredientsList.indexOf(b);c>-1&&ingredientsList.splice(c,1),$(this).unbind("click"),$(this).parent().remove(),g(),h()}),b.appendTo(a),g(),h()},k=function(){$.ajaxSetup({headers:{"X-Mashape-Key":"Fsz4qtOaKNmshsm6NqrJIFaLjD6jp1lWBaMjsn7wQaIvTisGiS"}}),$("#scotch-panel").scotchPanel({containerSelector:"body",direction:"right",duration:300,transition:"ease",clickSelector:".toggle-panel",distanceX:"320px",enableEscapeKey:!0}),$(".popup-modal").magnificPopup({type:"inline",preloader:!1,modal:!0}),$(document).on("click",".popup-modal-dismiss",function(a){a.preventDefault(),$.magnificPopup.close()}),d(),$("#ingredients").autocomplete({valueKey:"name",limit:12,visibleLimit:6,source:[{url:"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/food/ingredients/autocomplete?metaInformation=false&number=10&query=%QUERY%",type:"remote"}],getTitle:function(a){return a.name},getValue:function(a){return a.name}}).on("selected.xdsoft",function(a,b){currentItem=$("#ingredients").val(),ingredientsList.includes(currentItem)||(ingredientsList.push(currentItem),$("#mainIngredients h3").hide(),$("#mainIngredients label").text("Add ingredient"),j())}),i(),$("#create_pdf").on("click",function(){createPDF()})};k()});